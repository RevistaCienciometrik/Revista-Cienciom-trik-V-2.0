<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cienciométrik - Panel de Revisor</title>
    <link rel="stylesheet" href="../CSS/styles.css">
    <link rel="stylesheet" href="revisor.css">
</head>
<body>
    <mi-header></mi-header>

    <div class="container">
        <aside class="sidebar">
            <h3>Panel de Revisor</h3>
            <nav>
                <ul>
                    <li>
                        <i class="fas fa-eye"></i>
                        <a href="#revision-articulos" class="sidebar-link active">Artículos Pendientes de Revisión</a>
                    </li>
                    <li>
                        <i class="fas fa-check-double"></i>
                        <a href="#articulos-revisados" class="sidebar-link">Historial de Artículos Revisados</a>
                    </li>
                    </ul>
            </nav>
            <div class="sidebar-bottom">
                <a href="#" class="logout-link">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </a>
            </div>
        </aside>

        <main class="main-content">
            <section id="bienvenida" class="revisor-section">
                <h2>Hola! <span id="revisor-nombre"> [Nombre del Revisor]</span></h2>
                <p>Aquí puedes gestionar y evaluar los artículos enviados por los autores. Tu labor es fundamental para asegurar la calidad y rigurosidad de las publicaciones en Cienciométrik.</p>
                <p>Utiliza esta interfaz para:</p>
                <ul>
                    <li>Revisar el contenido de los artículos.</li>
                    <li>Añadir observaciones detalladas para los autores.</li>
                    <li>Aprobar artículos para la revisión final por el administrador.</li>
                    <li>Rechazar artículos que no cumplan con los estándares, indicando los motivos.</li>
                </ul>
            </section>

            <section id="revision-articulos" class="revisor-section">
                <h3>Artículos Pendientes de Revisión</h3>
                <p>A continuación, encontrarás los artículos que han sido enviados y están a la espera de tu evaluación.</p>

                <div class="table-container">
                    <table class="revisor-table">
                        <thead>
                            <tr>
                                <th>Título del Artículo</th>
                                <th>Autor</th>
                                <th>Fecha de Envío</th>
                                <th>Estado Actual</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-article-id="art001">
                                <td data-label="Título del Artículo">Importancia de la Minería de Datos en la Cienciometría</td>
                                <td data-label="Autor">Dr. Juan Pérez</td>
                                <td data-label="Fecha de Envío">2024-05-15</td>
                                <td data-label="Estado Actual">
                                    <span class="status status-pending">Pendiente de Revisión</span>
                                </td>
                                <td data-label="Acciones" class="actions">
                                    <button class="button-primary view-article-button" title="Ver Artículo Completo">
                                        <i class="fas fa-file-alt"></i> Ver
                                    </button>
                                    <button class="button-secondary add-observations-button" title="Añadir Observaciones">
                                        <i class="fas fa-comment-dots"></i> Observaciones
                                    </button>
                                    <button class="button-success approve-button" title="Aprobar para Admin">
                                        <i class="fas fa-check"></i> Aprobar
                                    </button>
                                    <button class="button-danger reject-button" title="Rechazar Artículo">
                                        <i class="fas fa-times"></i> Rechazar
                                    </button>
                                </td>
                            </tr>
                            <tr data-article-id="art002">
                                <td data-label="Título del Artículo">Análisis Bibliométrico de Publicaciones sobre IA en Colombia</td>
                                <td data-label="Autor">Lic. Ana Gómez</td>
                                <td data-label="Fecha de Envío">2024-05-18</td>
                                <td data-label="Estado Actual">
                                    <span class="status status-pending">Pendiente de Revisión</span>
                                </td>
                                <td data-label="Acciones" class="actions">
                                    <button class="button-primary view-article-button" title="Ver Artículo Completo">
                                        <i class="fas fa-file-alt"></i> Ver
                                    </button>
                                    <button class="button-secondary add-observations-button" title="Añadir Observaciones">
                                        <i class="fas fa-comment-dots"></i> Observaciones
                                    </button>
                                    <button class="button-success approve-button" title="Aprobar para Admin">
                                        <i class="fas fa-check"></i> Aprobar
                                    </button>
                                    <button class="button-danger reject-button" title="Rechazar Artículo">
                                        <i class="fas fa-times"></i> Rechazar
                                    </button>
                                </td>
                            </tr>
                            </tbody>
                    </table>
                </div>
            </section>

            <section id="articulos-revisados" class="revisor-section">
                <h3>Historial de Artículos Revisados</h3>
                <p>Aquí puedes consultar los artículos que ya has procesado.</p>
                <div class="table-container">
                    <table class="revisor-table">
                        <thead>
                            <tr>
                                <th>Título del Artículo</th>
                                <th>Autor</th>
                                <th>Fecha de Revisión</th>
                                <th>Mi Veredicto</th>
                                <th>Observaciones</th>
                                <th>Estado Final (Admin)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-article-id="art003">
                                <td data-label="Título del Artículo">Metodologías de Evaluación de Impacto Científico</td>
                                <td data-label="Autor">Dr. Carlos López</td>
                                <td data-label="Fecha de Revisión">2024-05-10</td>
                                <td data-label="Mi Veredicto">
                                    <span class="status status-approved"><i class="fas fa-check-circle"></i> Aprobado</span>
                                </td>
                                <td data-label="Observaciones">
                                    <button class="button-info view-observations-button" data-observations="Revisado y aprobado. Buena estructura, faltan algunas referencias.">Ver</button>
                                </td>
                                <td data-label="Estado Final (Admin)">
                                    <span class="status status-pending">Pendiente de Admin</span>
                                </td>
                            </tr>
                            <tr data-article-id="art004">
                                <td data-label="Título del Artículo">Desafíos de la Ciencia Abierta en Latinoamérica</td>
                                <td data-label="Autor">M.Sc. Laura Fernández</td>
                                <td data-label="Fecha de Revisión">2024-05-08</td>
                                <td data-label="Mi Veredicto">
                                    <span class="status status-rejected"><i class="fas fa-times-circle"></i> Rechazado</span>
                                </td>
                                <td data-label="Observaciones">
                                    <button class="button-info view-observations-button" data-observations="Temática interesante pero la metodología no está clara y faltan datos de soporte. Requiere revisión profunda.">Ver</button>
                                </td>
                                <td data-label="Estado Final (Admin)">
                                    <span class="status status-rejected">Rechazado por Revisor</span>
                                </td>
                            </tr>
                            <tr data-article-id="art005">
                                <td data-label="Título del Artículo">Indicadores Bibliométricos para la Evaluación de Revistas</td>
                                <td data-label="Autor">Dra. Sofía Vargas</td>
                                <td data-label="Fecha de Revisión">2024-05-01</td>
                                <td data-label="Mi Veredicto">
                                    <span class="status status-approved"><i class="fas fa-check-circle"></i> Aprobado</span>
                                </td>
                                <td data-label="Observaciones">
                                    <button class="button-info view-observations-button" data-observations="Artículo de excelente calidad, recomendado para publicación.">Ver</button>
                                </td>
                                <td data-label="Estado Final (Admin)">
                                    <span class="status status-published"><i class="fas fa-globe"></i> Publicado</span>
                                </td>
                            </tr>
                            </tbody>
                    </table>
                </div>
            </section>

            <div class="button-group-bottom">
                <button class="button-secondary back-to-top" onclick="window.scrollTo(0, 0);">
                    <i class="fas fa-arrow-up"></i> Volver Arriba
                </button>
                <a href="#" class="logout-button button-danger">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </a>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Placeholder para el nombre del revisor (se llenaría con datos del backend)
            const revisorNameElement = document.getElementById('revisor-nombre');
            if (revisorNameElement) {
                // Simulación: en un caso real, esto vendría de una sesión o API
                revisorNameElement.textContent = "Andrea Restrepo";
            }

            // Manejo de la navegación de la barra lateral
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    const targetId = this.getAttribute('href').substring(1);
                    document.querySelectorAll('.revisor-section').forEach(section => {
                        section.style.display = 'none';
                    });
                    document.getElementById(targetId).style.display = 'block';
                });
            });

            // Asegurarse de que la sección activa se muestre al cargar
            const activeLink = document.querySelector('.sidebar-link.active');
            if (activeLink) {
                const targetId = activeLink.getAttribute('href').substring(1);
                document.getElementById(targetId).style.display = 'block';
            } else {
                // Por defecto, mostrar la sección de bienvenida o la primera sección de la lista
                document.getElementById('bienvenida').style.display = 'block';
            }

            // Funcionalidad de los botones de acción para artículos pendientes
            document.querySelectorAll('.revisor-table .view-article-button').forEach(button => {
                button.addEventListener('click', function() {
                    const articleId = this.closest('tr').getAttribute('data-article-id');
                    alert(`Simulando vista del artículo ${articleId}. Aquí se abriría un visor o se redirigiría a la página del artículo.`);
                });
            });

            document.querySelectorAll('.revisor-table .add-observations-button').forEach(button => {
                button.addEventListener('click', function() {
                    const articleId = this.closest('tr').getAttribute('data-article-id');
                    const observations = prompt(`Añade tus observaciones para el artículo ${articleId}:`);
                    if (observations) {
                        alert(`Observaciones guardadas para el artículo ${articleId}: "${observations}"`);
                        // Aquí enviarías las observaciones al backend y actualizarías el estado si es necesario
                    }
                });
            });

            document.querySelectorAll('.revisor-table .approve-button').forEach(button => {
                button.addEventListener('click', function() {
                    const row = this.closest('tr');
                    const articleId = row.getAttribute('data-article-id');
                    if (confirm(`¿Estás seguro de aprobar el artículo ${articleId} para revisión del administrador?`)) {
                        alert(`Artículo ${articleId} aprobado para revisión de administrador.`);
                        // Actualizar el estado visualmente
                        const statusSpan = row.querySelector('.status');
                        statusSpan.className = 'status status-approved-revisor';
                        statusSpan.innerHTML = '<i class="fas fa-check-circle"></i> Aprobado para Admin';
                        // Deshabilitar botones de acción después de aprobar/rechazar
                        row.querySelectorAll('.approve-button, .reject-button').forEach(btn => btn.disabled = true);
                        // También podrías mover la fila a la sección de "Historial de Artículos Revisados"
                    }
                });
            });

            document.querySelectorAll('.revisor-table .reject-button').forEach(button => {
                button.addEventListener('click', function() {
                    const row = this.closest('tr');
                    const articleId = row.getAttribute('data-article-id');
                    const reason = prompt(`Indica el motivo del rechazo para el artículo ${articleId}:`);
                    if (reason) {
                        if (confirm(`¿Estás seguro de rechazar el artículo ${articleId}? Motivo: "${reason}"`)) {
                            alert(`Artículo ${articleId} rechazado. Motivo: "${reason}"`);
                            // Actualizar el estado visualmente
                            const statusSpan = row.querySelector('.status');
                            statusSpan.className = 'status status-rejected';
                            statusSpan.innerHTML = '<i class="fas fa-times-circle"></i> Rechazado por Revisor';
                            // Deshabilitar botones de acción después de aprobar/rechazar
                            row.querySelectorAll('.approve-button, .reject-button').forEach(btn => btn.disabled = true);
                            // También podrías mover la fila a la sección de "Historial de Artículos Revisados"
                        }
                    } else {
                        alert("Debes proporcionar un motivo para rechazar el artículo.");
                    }
                });
            });

            // Funcionalidad para ver observaciones en el historial
            document.querySelectorAll('.revisor-table .view-observations-button').forEach(button => {
                button.addEventListener('click', function() {
                    const observations = this.getAttribute('data-observations');
                    alert('Observaciones: ' + observations);
                });
            });

            // Cerrar Sesión (simulado)
            document.querySelectorAll('.logout-link, .logout-button').forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    // Aquí iría la lógica real para cerrar la sesión (limpiar cookies, tokens, etc.)
                    alert("Has cerrado sesión. Redirigiendo a la página de inicio...");
                    window.location.href = "/index.html"; // O la página de login
                });
            });
        });
    </script>

        <mi-footer></mi-footer>

    <script src="header_admin.js"></script>
    <script src="/Objects/container.js"></script>
    <script src="footer_admin.js"></script>
    <script src="/Objects/script.js"></script>

</body>
</html>